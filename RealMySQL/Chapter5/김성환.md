특정 DB 상태를 변경하는 트랜잭션과 함께 이벤트를 발행해야할 때가 있습니다. 이때 정합성을 보장해 주어야할 때 트랜잭션을 어떻게 걸어야할까요?
예를 들어 사용자가 상품을 주문함 → 주문 정보는 DB에 저장됨, 동시에 배송 서비스에 "배송 시작 요청" 이벤트를 보내야할 때
만약 DB 저장은 성공했는데, 이벤트 발행은 실패하면? → 배송이 시작되지 않음
반대로 이벤트는 발행됐지만 DB 저장은 실패하면? → 배송은 갔는데 주문이 없음
이런 문제를 어떻게 해결할 수 있을까요?
